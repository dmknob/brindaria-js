MASTER-PLAN: Brindaria V2 (Engineering & Product)Versão do Documento: 1.0 (Pós-Lançamento V2.0)Status: Produção Estável | Iniciando Planejamento V2.11. Identidade do Projeto e EscopoNome do Sistema: Brindaria CMS & Auth (V2).A "Dor" Original: Substituir um site estático (V1) de difícil manutenção manual (JSON) por um sistema dinâmico que permitisse a gestão de conteúdo e a criação de páginas únicas para peças físicas.Pivotagem Estratégica:De: Foco inicial em links de compartilhamento viral.Para: Sistema de Autenticação Phygital. O foco central tornou-se a validação da peça física através de uma Chave de Acesso (QR Code na base) e a Curadoria de Conteúdo (História Rica das Figuras).Evolução: O sistema está se transformando em um ERP leve de produção.Stack Tecnológica:Runtime: Node.js (LTS v20+).Framework: Express.js.Database: SQLite3 (Lib: better-sqlite3).Frontend: EJS (Server-Side Rendering) + Tailwind CSS.Infraestrutura: Servidor Debian 12, Nginx (Proxy Reverso), PM2, Git.2. Snapshot do Estado Atual (V2.0 - Produção)Funcionalidades Operacionais:Público: Home Institucional, Catálogo de Peças, Página de Detalhe Rica (História/Oração/Iconografia), Certificado de Autenticidade (acessível via Chave ou Código), Busca por Chave (/validar), Sitemap XML dinâmico.Admin: Login Seguro (Hash + Rate Limit), Dashboard com métricas, CRUD de Modelos (com upload de imagem e texto rico), CRUD de Peças (com geração de Chave Única), Backup do Sistema (Zip).Arquitetura de Pastas: Estrutura MVC (src/controllers, src/models implícito no SQL, src/routes, views/).Arquitetura de View: Layout "Sanduíche" (layout-top.ejs + content + layout-bottom.ejs) para garantir estabilidade do rodapé.3. Registros de Decisão de Arquitetura (ADR)ADR-01: Banco de Dados SQLite: Escolhido pela portabilidade (arquivo único) e baixo custo de manutenção.ADR-02: Desativação do modo WAL: O modo Write-Ahead Logging foi desativado após incidentes de perda de dados durante deploys/resets. O sistema opera em modo padrão (arquivo .db único) para facilitar backups frios e quentes.ADR-03: Chaves de Acesso (Crockford Base32): Implementado sistema de chaves de 5 caracteres (ex: A7X2M) para identificar peças inequivocamente e permitir URLs curtas.ADR-04: Separação de Ambientes (Dev/Staging/Prod):Prod: Fonte da verdade dos DADOS.Staging/Dev: Fonte da verdade do CÓDIGO.Sync: Dados descem (Dump de Prod -> Staging), Código sobe (Git Push -> Prod).ADR-05: Imagens no Filesystem: Uploads salvos em disco local (public/uploads). Backup de imagens é feito via ZIP no painel Admin.4. Backlog Consolidado (Roadmap V2.1)Esta é a especificação técnica para o próximo ciclo de desenvolvimento.4.1. Refatoração Semântica e Estrutural (Alta Prioridade)[Banco de Dados] Renomeação de Tabelas:Tabela modelos -> figuras.Coluna modelo_id -> figura_id em todas as tabelas relacionadas.[Interface] Renomeação Visual:Alterar todos os labels, menus e mensagens de "Modelo" para "Figura".Conceito: "Figura" é a entidade sagrada; "Peça" é a materialização física.4.2. Workflow de Cadastro e Publicação[Feature] Status Ativo/Inativo (Rascunho):Adicionar coluna ativo na tabela figuras.Figuras nascem inativas. Site público filtra WHERE ativo = 1.[Feature] Cadastro de Peça "Express" (Relaxamento de Constraints):Objetivo: Permitir cadastrar a peça assim que sai da impressora.Técnica: Alterar colunas codigo_exibicao, mensagem, cliente, data, acabamento para permitir NULL.Obrigatórios: Apenas figura_id e chave_acesso.4.3. Gestão de Categorias (CRUD Completo)[Feature] Edição e Exclusão:Permitir editar nome da categoria.Trava de Segurança (RESTRICT): Impedir exclusão de categoria se houver Figuras vinculadas.Trava de SEO: Impedir edição do slug da categoria para não quebrar links/QR Codes.4.4. Melhorias de Interface Pública[UX] URL Curta: Implementar rota /v/:chave para acesso direto via QR Code.[SEO] Canonical: Inserir tag canonical nas páginas de peças apontando para a página da Figura pai.5. O "Laboratório de Ideias" (V3.0+)Arquitetura Vanguard (V3.0):Migrar o frontend público para Estático (SSG On-Demand).Node.js gera arquivos .html físicos a cada atualização no Admin.Nginx serve arquivos estáticos (Performance máxima, Segurança total).Módulo ERP (V3.x):Tabela satélite producao (1:1 com pecas) para dados sensíveis (custo, status, impressora).Impressão de Ordem de Produção (HTML/CSS A5).Busca Avançada (V3.1):Sistema de Tags (atributos_visuais) para filtros como "Santos com Espada".6. Próximos Passos Imediatos (Action Plan)Para iniciar o desenvolvimento da V2.1, o comando deve ser focado na preparação do banco de dados para a refatoração.Comando sugerido para o Assistente:"Vamos iniciar a V2.1. O primeiro passo é criar o script de migração de banco (migrate_v2_to_v2.1.js) que fará a renomeação da tabela 'modelos' para 'figuras', adicionará o campo 'ativo' e relaxará as restrições NOT NULL da tabela 'pecas'. Por favor, escre